{% extends 'core/base.html' %}

{% block title %}{{ project.title }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><i class="fas fa-project-diagram me-2"></i>{{ project.title }}</h2>
  <div>
    <a href="{% url 'project_update' project.pk %}" class="btn btn-warning">
      <i class="fas fa-edit me-1"></i>Edit
    </a>
    <a href="{% url 'project_delete' project.pk %}" class="btn btn-danger">
      <i class="fas fa-trash me-1"></i>Delete
    </a>
    <a href="{% url 'project_list' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left me-1"></i>Back to List
    </a>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h5><i class="fas fa-info-circle me-2"></i>Project Details</h5>
      </div>
      <div class="card-body">
        <table class="table table-borderless">
          <tr>
            <th style="width: 30%;">Project ID:</th>
            <td>{{ project.project_id }}</td>
          </tr>
          <tr>
            <th>Title:</th>
            <td>{{ project.title }}</td>
          </tr>
          <tr>
            <th>Nature:</th>
            <td>{{ project.nature_of_project }}</td>
          </tr>
          <tr>
            <th>Program:</th>
            <td><a href="{% url 'program_detail' project.program.pk %}">{{ project.program.name }}</a></td>
          </tr>
          <tr>
            <th>Facility:</th>
            <td><a href="{% url 'facility_detail' project.facility.pk %}">{{ project.facility.name }}</a></td>
          </tr>
          <tr>
            <th>Innovation Focus:</th>
            <td>{{ project.innovation_focus|default:"N/A" }}</td>
          </tr>
          <tr>
            <th>Prototype Stage:</th>
            <td>{{ project.prototype_stage|default:"N/A" }}</td>
          </tr>
        </table>
      </div>
    </div>

    <div class="card mt-4">
      <div class="card-header">
        <h5><i class="fas fa-align-left me-2"></i>Description</h5>
      </div>
      <div class="card-body">
        {{ project.description|linebreaks }}
      </div>
    </div>

    {% if project.testing_requirements %}
    <div class="card mt-4">
      <div class="card-header">
        <h5><i class="fas fa-vial me-2"></i>Testing Requirements</h5>
      </div>
      <div class="card-body">
        {{ project.testing_requirements|linebreaks }}
      </div>
    </div>
    {% endif %}

    {% if project.commercialization_plan %}
    <div class="card mt-4">
      <div class="card-header">
        <h5><i class="fas fa-chart-line me-2"></i>Commercialization Plan</h5>
      </div>
      <div class="card-body">
        {{ project.commercialization_plan|linebreaks }}
      </div>
    </div>
    {% endif %}
  </div>

  <div class="col-md-4">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5><i class="fas fa-users me-2"></i>Participants</h5>
        <a href="{% url 'project_participant_create' project.pk %}" class="btn btn-sm btn-primary">
          <i class="fas fa-plus me-1"></i>Add Participant
        </a>
      </div>
      <div class="card-body">
        {% if project.project_participants.all %}
          {% for pp in project.project_participants.all %}
            <div class="d-flex justify-content-between align-items-center mb-2">
              <div>
                <strong>{{ pp.participant.full_name }}</strong><br>
                <small class="text-muted">{{ pp.role_on_project }} - {{ pp.skill_role }}</small>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-muted">No participants assigned yet.</p>
        {% endif %}
      </div>
    </div>

    <div class="card mt-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5><i class="fas fa-clipboard-check me-2"></i>Outcomes</h5>
        <a href="{% url 'outcome_create' %}?project={{ project.pk }}" class="btn btn-sm btn-primary">
          <i class="fas fa-plus me-1"></i>Add Outcome
        </a>
      </div>
      <div class="card-body">
        {% if project.outcomes.all %}
          {% for outcome in project.outcomes.all %}
            <div class="mb-2">
              <strong>{{ outcome.title }}</strong><br>
              <small class="text-muted">{{ outcome.outcome_type }}</small>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-muted">No outcomes recorded yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
